<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>M.S.L. Portal</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- React & ReactDOM (React 18) -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>

    <!-- Babel (JSX変換用) -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Google Fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=Black+Ops+One&family=Quantico:ital,wght@0,400;0,700;1,400&family=IBM+Plex+Sans+JP:wght@400;500;700&family=JetBrains+Mono&family=Shippori+Mincho&display=swap"
        rel="stylesheet">

    <!-- カスタムスタイル -->
    <style>
        body {
            background-color: #0f172a;
            /* Slate-900 */
            color: white;
            margin: 0;
            font-family: 'IBM Plex Sans JP', sans-serif;
            overflow: hidden;
            /* アニメーション中のスクロール防止 */
        }

        /* フォント定義クラス */
        .font-logo {
            font-family: 'Black Ops One', system-ui;
        }

        .font-tech {
            font-family: 'Quantico', sans-serif;
        }

        /* 背景のアニメーション（ゆっくり明滅） */
        @keyframes pulse-bg {

            0%,
            100% {
                opacity: 0.2;
            }

            50% {
                opacity: 0.3;
            }
        }

        .animate-bg {
            animation: pulse-bg 8s ease-in-out infinite;
        }

        /* --- 起動シーケンスアニメーション (通常版) --- */

        /* 1. ロゴ: 中央に出現 → 待機 → 上へ移動 */
        @keyframes logoSequence {
            0% {
                opacity: 0;
                transform: translateY(20px) scale(1.1);
            }

            20% {
                opacity: 1;
                transform: translateY(15vh) scale(1.1);
                /* 中央付近で停止 */
            }

            60% {
                transform: translateY(15vh) scale(1.1);
                /* 待機 */
            }

            100% {
                opacity: 1;
                transform: translateY(0) scale(1);
                /* 定位置へ移動 */
            }
        }

        .anim-logo-wrapper {
            /* 4.5s -> 2.5s に短縮 */
            animation: logoSequence 2.5s cubic-bezier(0.16, 1, 0.3, 1) forwards;
        }

        /* 2. コンテンツ: ロゴ移動後にフェードイン */
        @keyframes contentFadeIn {
            from {
                opacity: 0;
                transform: translateY(15px);
                pointer-events: none;
            }

            to {
                opacity: 1;
                transform: translateY(0);
                pointer-events: auto;
            }
        }

        .anim-content-wrapper {
            opacity: 0;
            pointer-events: none;
            /* 開始タイミング: 4.0s -> 2.2s に短縮 */
            animation: contentFadeIn 0.8s ease-out 2.2s forwards;
        }

        /* 3. フッター */
        .anim-footer {
            opacity: 0;
            /* 開始タイミング: 5.0s -> 2.8s に短縮 */
            animation: contentFadeIn 0.8s ease-out 2.8s forwards;
        }

        /* --- スキップ用スタイル (即時表示) --- */
        .skip-animation {
            opacity: 1 !important;
            transform: translateY(0) !important;
            animation: none !important;
            pointer-events: auto !important;
        }
    </style>
</head>

<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        const App = () => {
            const [isVisited, setIsVisited] = useState(false);

            // 初回ロード時に訪問済みかチェック
            useEffect(() => {
                const visited = sessionStorage.getItem('msl_portal_visited');
                if (visited) {
                    setIsVisited(true);
                } else {
                    // 初回訪問ならフラグを立てる
                    sessionStorage.setItem('msl_portal_visited', 'true');
                }
            }, []);

            // 画面遷移ハンドラ
            const handleNavigate = (target) => {
                if (target === 'world') {
                    window.location.href = './public/index.html';
                } else if (target === 'dev') {
                    window.location.href = './dev/index.html';
                } else {
                    console.log(`Navigating to: ${target}`);
                }
            };

            // アニメーション用クラスの決定
            // 訪問済みなら 'skip-animation' を付与してアニメーションを無効化
            const logoClass = isVisited ? 'skip-animation' : 'anim-logo-wrapper';
            const contentClass = isVisited ? 'skip-animation' : 'anim-content-wrapper';
            const footerClass = isVisited ? 'skip-animation' : 'anim-footer';

            return (
                <div className="min-h-screen flex flex-col items-center justify-center p-4 relative">

                    {/* 背景装飾 */}
                    <div className="absolute inset-0 pointer-events-none animate-bg"
                        style={{ backgroundImage: 'radial-gradient(circle at 50% 50%, #1e293b 0%, #0f172a 100%)' }}>
                    </div>

                    {/* --- 1. ロゴセクション --- */}
                    <div className={`text-center mb-16 z-10 ${logoClass}`}>
                        <h1 className="text-6xl md:text-8xl font-logo mb-2 text-white opacity-90 tracking-[0.1rem]"
                            style={{ textShadow: '0 0 30px rgba(59, 130, 246, 0.3)' }}>
                            M.S.L.
                        </h1>

                        <div className="flex flex-col items-center gap-1">
                            <div className="h-px w-32 bg-blue-500/50 mb-2"></div>
                            <p className="text-blue-400 text-sm md:text-base font-tech tracking-[0.3em] uppercase font-bold">
                                Multiphase Synchronous Logic
                            </p>
                            <p className="text-gray-500 text-[10px] font-tech tracking-widest">
                                SYSTEM VER. 1.0.0 // READY
                            </p>
                        </div>
                    </div>

                    {/* --- 2. ナビゲーションセクション --- */}
                    <div className={`flex flex-col md:flex-row gap-6 w-full max-w-4xl z-10 ${contentClass}`}>

                        {/* ① Public Archive ボタン */}
                        <button
                            onClick={() => handleNavigate('world')}
                            className="
                                flex-1 
                                border border-yellow-600/30 
                                bg-yellow-900/10
                                p-8 rounded-lg 
                                text-left 
                                hover:bg-yellow-900/20 
                                hover:border-yellow-600/80
                                active:bg-yellow-900/40
                                transition-all duration-300
                                group
                                backdrop-blur-sm
                            "
                        >
                            <div className="text-yellow-600 font-tech text-xs mb-2 tracking-widest group-hover:text-yellow-400 transition-colors">
                                LAYER: WORLD
                            </div>
                            <h2 className="text-2xl font-bold mb-3 text-yellow-100 group-hover:text-white group-hover:translate-x-1 transition-all">
                                一般公開アーカイブ
                            </h2>
                            <p className="text-gray-400 text-xs md:text-sm leading-relaxed group-hover:text-yellow-200/80 font-medium">
                                魔法史、魔素物理学、社会情勢に関する<br />
                                一般市民向け資料データベース。
                            </p>
                        </button>

                        {/* ② Authorized Access ボタン */}
                        <button
                            onClick={() => handleNavigate('dev')}
                            className="
                                flex-1 
                                border border-blue-600/30 
                                bg-blue-900/10
                                p-8 rounded-lg 
                                text-left 
                                hover:bg-blue-900/20 
                                hover:border-blue-500/80
                                active:bg-blue-900/40
                                transition-all duration-300
                                group
                                backdrop-blur-sm
                            "
                        >
                            <div className="text-blue-600 font-tech text-xs mb-2 tracking-widest group-hover:text-blue-400 transition-colors">
                                LAYER: DEV
                            </div>
                            <h2 className="text-2xl font-bold mb-3 text-blue-100 group-hover:text-white group-hover:translate-x-1 transition-all">
                                有資格者エリア
                            </h2>
                            <p className="text-gray-400 text-xs md:text-sm leading-relaxed group-hover:text-blue-200/80 font-medium">
                                M.S.L.仕様書、APIリファレンス、<br />
                                カートリッジ安全運用規定。
                            </p>
                        </button>

                    </div>

                    {/* --- 3. フッター --- */}
                    <footer className={`fixed bottom-4 text-gray-600 text-[10px] font-tech tracking-wider flex gap-4 z-10 ${footerClass}`}>
                        <span>© 2025 Magic Development Bureau</span>
                        <span className="text-gray-700">::</span>
                        <span>SECURE CONNECTION ESTABLISHED</span>
                    </footer>

                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>

</html>